<mat-card>
<mat-card-header>
  <mat-card-title>
    <span
      [ngClass]="{ active: isLoginMode() }"
      (click)="!isLoginMode() && switchMode()"
      style="cursor: pointer;"
    >
      Login
    </span>
    <span class="divider">|</span>
    <span
      [ngClass]="{ active: !isLoginMode() }"
      (click)="isLoginMode() && switchMode()"
      style="cursor: pointer;"
    >
      Register
    </span>
  </mat-card-title>
  <mat-card-subtitle>
    {{ isLoginMode() ? 'Access your account' : 'Create a new account' }}
  </mat-card-subtitle>
</mat-card-header>

<form [formGroup]="authForm" (ngSubmit)="onSubmit()" autocomplete="off">
  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Email</mat-label>
    <input matInput type="email" formControlName="email" placeholder="Enter your email" autocomplete="username" />
    <mat-error *ngIf="authForm.get('email')?.invalid && authForm.get('email')?.touched">
      Please enter a valid email address.
    </mat-error>
  </mat-form-field>

  <mat-form-field appearance="outline" class="full-width">
    <mat-label>Password</mat-label>
    <input matInput type="password" formControlName="password" placeholder="Enter your password" autocomplete="current-password" />
    <mat-error *ngIf="authForm.get('password')?.invalid && authForm.get('password')?.touched">
      Password must be at least 6 characters long.
    </mat-error>
  </mat-form-field>

  <!-- Show confirm password only in register mode -->
  <mat-form-field *ngIf="!isLoginMode()" appearance="outline" class="full-width">
    <mat-label>Confirm Password</mat-label>
    <input matInput type="password" formControlName="confirmPassword" placeholder="Confirm your password" autocomplete="new-password" />
    <mat-error *ngIf="authForm.get('confirmPassword')?.touched && authForm.get('confirmPassword')?.value !== authForm.get('password')?.value">
      Passwords do not match.
    </mat-error>
  </mat-form-field>

  <button
    mat-raised-button
    color="primary"
    class="full-width"
    type="submit"
    [disabled]="authForm.invalid || loading()"
  >
    {{ isLoginMode() ? 'Login' : 'Register' }}
  </button>
</form>

<!-- Messages -->
<div *ngIf="loginError()" class="ntt-error-message">{{ loginError() }}</div>
<div *ngIf="loginSuccess() && isLoginMode()" class="ntt-success-message">Login successful!</div>
<div *ngIf="loginSuccess() && !isLoginMode()" class="ntt-success-message">Registration successful! Please log in.</div>

<!-- Toggle links -->
<div class="toggle-link" *ngIf="isLoginMode()">
  Don't have an account?
  <a (click)="switchMode()" style="cursor: pointer;">Register</a>
</div>
<div class="toggle-link" *ngIf="!isLoginMode()">
  Already have an account?
  <a (click)="switchMode()" style="cursor: pointer;">Login</a>
</div>
</mat-card>